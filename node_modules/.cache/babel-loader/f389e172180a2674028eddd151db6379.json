{"ast":null,"code":"import _objectSpread from \"/Users/rachelemilyperez/projects/noteful-app/noteful-app-client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/rachelemilyperez/projects/noteful-app/noteful-app-client/src/App/App.js\";\nimport React, { Component } from 'react';\nimport { Route, Link } from 'react-router-dom';\nimport { withRouter } from 'react-router-dom';\nimport NoteListNav from '../NoteListNav/NoteListNav';\nimport NotePageNav from '../NotePageNav/NotePageNav';\nimport NoteListMain from '../NoteListMain/NoteListMain';\nimport NotePageMain from '../NotePageMain/NotePageMain';\nimport AddFolder from '../AddFolder/AddFolder';\nimport AddNote from '../AddNote/AddNote';\nimport EditNote from '../EditNote/EditNote';\nimport EditFolder from '../EditFolder/EditFolder';\nimport Folder from '../Folder/Folder';\nimport ApiContext from '../ApiContext';\nimport config from '../config';\nimport './App.css';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      folders: []\n    };\n\n    this.addFolder = folder => {\n      this.setState({\n        folders: [...this.state.folders, folder]\n      });\n    };\n\n    this.mergeFoldersAndNotes = (folders, notes) => {\n      notes.forEach(note => {\n        const index = folders.findIndex(f => f.id === note.folder);\n\n        if (!folders[index].notes) {\n          folders[index].notes = [];\n        }\n\n        folders[index].notes.push({\n          id: note.id,\n          name: note.name,\n          content: note.content,\n          date: note.date\n        });\n        console.log(folders[index].notes);\n      });\n      return folders;\n    };\n\n    this.addNote = (folders, note) => {\n      let copy = [...folders];\n      const i = this.state.folders.findIndex(folder => {\n        return folder.id === +note.folder;\n      });\n      copy[i].notes.push(note);\n      this.setState({\n        folders: copy\n      });\n    };\n\n    this.handleDeleteNote = id => {\n      const newFolders = this.state.folders.map(folder => {\n        folder.notes = folder.notes.filter(note => note.id !== id);\n        return folder;\n      });\n      this.setState({\n        folders: newFolders\n      });\n    };\n\n    this.handleDeleteFolder = folderId => {\n      this.setState({\n        folders: this.state.folders.filter(folder => folder.id !== folderId)\n      });\n    };\n\n    this.updateFolder = updatedFolder => {\n      const newFolders = this.state.folders.map(folder => folder.id === updatedFolder.id ? updatedFolder : folder);\n      this.setState({\n        folders: newFolders\n      });\n    };\n\n    this.updateNote = editedNote => {\n      const folderIndex = this.state.folders.findIndex(folder => folder.id === +editedNote.folder);\n      const folder = this.state.folders[folderIndex];\n      const noteIndex = folder.notes.findIndex(n => n.id === editedNote.id);\n      let note = folder.notes[noteIndex];\n\n      let newNote = _objectSpread({}, note, editedNote);\n\n      folder.notes.push(newNote);\n      const newFolders = [...this.state.folders.slice(0, folderIndex), folder, ...this.state.folders.slice(folderIndex + 1)];\n      this.setState({\n        folders: newFolders\n      });\n    };\n  }\n\n  componentDidMount() {\n    Promise.all([fetch(\"\".concat(config.API_ENDPOINT, \"/api/notes\")), fetch(\"\".concat(config.API_ENDPOINT, \"/api/folders\"))]).then(([notesRes, foldersRes]) => {\n      if (!notesRes.ok) return notesRes.json().then(e => Promise.reject(e));\n      if (!foldersRes.ok) return foldersRes.json().then(e => Promise.reject(e));\n      return Promise.all([notesRes.json(), foldersRes.json()]);\n    }).then(([notes, folders]) => {\n      const data = this.mergeFoldersAndNotes(folders, notes);\n      this.setState({\n        folders: data\n      });\n    }).catch(error => {\n      console.error({\n        error\n      });\n    });\n  }\n\n  renderNavRoutes() {\n    return React.createElement(React.Fragment, null, ['/', '/folder/:folderId'].map(path => React.createElement(Route, {\n      exact: true,\n      key: path,\n      path: path,\n      component: NoteListNav,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    })), React.createElement(Route, {\n      path: \"/note/:noteId\",\n      component: NotePageNav,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/add-folder\",\n      component: NotePageNav,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/add-note\",\n      component: NotePageNav,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/folder/:folderId\",\n      component: Folder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }));\n  }\n\n  renderMainRoutes() {\n    const notes = this.state.folders.notes;\n    return React.createElement(React.Fragment, null, ['/', '/folder/:folderId'].map(path => React.createElement(Route, {\n      exact: true,\n      key: path,\n      path: path,\n      component: NoteListMain,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    })), React.createElement(Route, {\n      path: \"/folder/:folderId\",\n      component: Folder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/note/:noteId\",\n      component: NotePageMain,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/add-folder\",\n      component: AddFolder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/add-note\",\n      component: AddNote,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/folders/:folderId/edit\",\n      component: EditFolder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/notes/:noteId/edit\",\n      component: EditNote,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }));\n  }\n\n  render() {\n    const value = {\n      folders: this.state.folders,\n      notes: this.notes,\n      deleteNote: this.handleDeleteNote,\n      deleteFolder: this.handleDeleteFolder,\n      addNote: this.addNote,\n      addFolder: this.addFolder,\n      updateFolder: this.updateFolder,\n      updateNote: this.updateNote\n    };\n    return React.createElement(ApiContext.Provider, {\n      value: value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      className: \"App__nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, this.renderNavRoutes()), React.createElement(\"header\", {\n      className: \"App__header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Noteful\"), ' ')), React.createElement(\"main\", {\n      className: \"App__main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, this.renderMainRoutes())));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/rachelemilyperez/projects/noteful-app/noteful-app-client/src/App/App.js"],"names":["React","Component","Route","Link","withRouter","NoteListNav","NotePageNav","NoteListMain","NotePageMain","AddFolder","AddNote","EditNote","EditFolder","Folder","ApiContext","config","App","state","folders","addFolder","folder","setState","mergeFoldersAndNotes","notes","forEach","note","index","findIndex","f","id","push","name","content","date","console","log","addNote","copy","i","handleDeleteNote","newFolders","map","filter","handleDeleteFolder","folderId","updateFolder","updatedFolder","updateNote","editedNote","folderIndex","noteIndex","n","newNote","slice","componentDidMount","Promise","all","fetch","API_ENDPOINT","then","notesRes","foldersRes","ok","json","e","reject","data","catch","error","renderNavRoutes","path","renderMainRoutes","render","value","deleteNote","deleteFolder"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {Route, Link} from 'react-router-dom';\nimport {withRouter} from 'react-router-dom';\nimport NoteListNav from '../NoteListNav/NoteListNav';\nimport NotePageNav from '../NotePageNav/NotePageNav';\nimport NoteListMain from '../NoteListMain/NoteListMain';\nimport NotePageMain from '../NotePageMain/NotePageMain';\nimport AddFolder from '../AddFolder/AddFolder';\nimport AddNote from '../AddNote/AddNote';\nimport EditNote from '../EditNote/EditNote';\nimport EditFolder from '../EditFolder/EditFolder';\nimport Folder from '../Folder/Folder';\nimport ApiContext from '../ApiContext';\nimport config from '../config';\nimport './App.css'\n\nclass App extends Component {\n\n    state = {\n        folders: []\n    }\n\n    addFolder = folder => {\n        this.setState({ \n            folders: [ ...this.state.folders, folder \n        ]})\n    }\n\n    mergeFoldersAndNotes = (folders, notes) => {\n        notes.forEach((note) => {\n          const index = folders.findIndex(f => f.id === note.folder) \n          if (!folders[index].notes) {\n            folders[index].notes = []\n          }\n          folders[index].notes.push({ \n            id: note.id, \n            name: note.name,\n            content: note.content,\n            date: note.date\n          })\n          console.log(folders[index].notes)\n          })\n        return folders\n    };\n \n    addNote = (folders, note) => {\n        let copy = [...folders]\n        const i = this.state.folders.findIndex(folder => {\n           return folder.id ===  +note.folder\n        })\n        copy[i].notes.push(note) \n        this.setState({\n            folders: copy\n        })\n    }\n     \n    handleDeleteNote = id => {\n        const newFolders = this.state.folders.map(folder => {\n          folder.notes = folder.notes.filter(note => note.id !== id)\n          return folder\n        })\n        this.setState({ folders: newFolders })\n      }\n\n    handleDeleteFolder = folderId => {\n        this.setState({\n            folders: this.state.folders.filter(folder => folder.id !== folderId)\n        });\n    };\n\n    componentDidMount() {\n        Promise.all([\n            fetch(`${config.API_ENDPOINT}/api/notes`),\n            fetch(`${config.API_ENDPOINT}/api/folders`)\n        ])\n            .then(([notesRes, foldersRes]) => {\n               \n                if (!notesRes.ok)\n                    return notesRes.json().then(e => Promise.reject(e));\n                if (!foldersRes.ok)\n                    return foldersRes.json().then(e => Promise.reject(e));\n                    \n                    return Promise.all([notesRes.json(), foldersRes.json()]);\n            })\n            .then(([notes, folders]) => {\n               const data = this.mergeFoldersAndNotes(folders, notes)\n                this.setState({folders: data})\n            })\n            .catch(error => {\n                console.error({error});\n            });\n    };\n\n    updateFolder = updatedFolder => {\n        const newFolders = this.state.folders.map(folder =>\n          (folder.id === updatedFolder.id)\n            ? updatedFolder\n            : folder\n        )\n        this.setState({\n        folders: newFolders\n        })\n    };\n\n    updateNote = editedNote => {\n        const folderIndex = this.state.folders.findIndex(folder => folder.id === +editedNote.folder)\n        const folder = this.state.folders[folderIndex]\n        const noteIndex = folder.notes.findIndex(n => n.id === editedNote.id)\n        let note = folder.notes[noteIndex]\n        let newNote = { ...note, ...editedNote }\n        folder.notes.push(newNote)\n        const newFolders = [\n            ...this.state.folders.slice(0, folderIndex),\n            folder,\n            ...this.state.folders.slice(folderIndex + 1)\n        ]\n        this.setState({\n           folders: newFolders\n        })\n    }\n\n    renderNavRoutes() {\n        return (\n            <>\n                {['/', '/folder/:folderId'].map(path => (\n                    <Route\n                        exact\n                        key={path}\n                        path={path}\n                        component={NoteListNav}\n                    />\n                ))}\n                <Route path=\"/note/:noteId\" component={NotePageNav}/>\n                <Route path=\"/add-folder\" component={NotePageNav}/>\n                <Route path=\"/add-note\" component={NotePageNav}/>\n                <Route path=\"/folder/:folderId\" component={Folder}/>\n            </>\n        );\n    }\n\n    renderMainRoutes() {\n        const notes  = this.state.folders.notes\n        return (\n\n            <>\n               {['/', '/folder/:folderId'].map(path => (\n                    <Route\n                        exact\n                        key={path}\n                        path={path}\n                        component={NoteListMain}\n                    />\n                ))} \n                <Route path='/folder/:folderId'component={Folder}/>\n                <Route path='/note/:noteId'component={NotePageMain}/>\n                <Route path='/add-folder' component={AddFolder}/>\n                <Route path='/add-note'component={AddNote}/>\n                <Route path='/folders/:folderId/edit' component={EditFolder}/> \n                <Route path='/notes/:noteId/edit' component={EditNote}/> \n            </>\n            \n        );\n    }\n\n    render() {\n        const value = {\n        folders: this.state.folders,\n        notes: this.notes,\n        deleteNote: this.handleDeleteNote,\n        deleteFolder: this.handleDeleteFolder,\n        addNote: this.addNote,\n        addFolder: this.addFolder,\n        updateFolder: this.updateFolder,\n        updateNote: this.updateNote,\n        };   \n\n        return (\n            <ApiContext.Provider value={value}>\n                <div className=\"App\">\n                    <nav className=\"App__nav\">{this.renderNavRoutes()}</nav>\n                    <header className=\"App__header\">\n                        <h1>\n                            <Link to=\"/\">Noteful</Link>{' '}\n                        </h1>\n                    </header>\n                    <main className=\"App__main\">{this.renderMainRoutes()}</main>\n                </div>\n            </ApiContext.Provider>\n        );\n    }\n}\n\nexport default withRouter(App)\n"]},"metadata":{},"sourceType":"module"}